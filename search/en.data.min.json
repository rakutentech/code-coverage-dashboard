[{"id":0,"href":"/code-coverage-dashboard/getting_started/","title":"1. Getting Started","parent":"Code Coverage Dashboard","content":""},{"id":1,"href":"/code-coverage-dashboard/usage/","title":"2. Usage","parent":"Code Coverage Dashboard","content":""},{"id":2,"href":"/code-coverage-dashboard/API/","title":"3. API","parent":"Code Coverage Dashboard","content":""},{"id":3,"href":"/code-coverage-dashboard/others/","title":"9. Others","parent":"Code Coverage Dashboard","content":""},{"id":4,"href":"/code-coverage-dashboard/","title":"Code Coverage Dashboard","parent":"","content":""},{"id":5,"href":"/code-coverage-dashboard/others/deployments/","title":"Deployments","parent":"9. Others","content":"Using it in a reverse proxy     cd server go build main.go \u0026amp;\u0026amp; ./start_server_api.sh "},{"id":6,"href":"/code-coverage-dashboard/API/get_coverages_api/","title":"GET /coverages-api","parent":"3. API","content":"Paginated list of coverages for all orgs and repos. Use this API for the dashboard to show all coverages in your organization.\ncurl localhost:3006/coverages-api?p=1 Request\nquery:\u0026quot;org_name\u0026quot; hint:\u0026quot;To filter by org name\u0026quot;` query:\u0026quot;repo_name\u0026quot; hint:\u0026quot;To filter by repository name\u0026quot;` query:\u0026quot;full\u0026quot; hint:\u0026quot;To include all history for trends\u0026quot;` query:\u0026quot;p\u0026quot; validate:\u0026quot;gte=0\u0026quot; message:\u0026quot;p greater than 0\u0026quot; hint:\u0026quot;Page number for pagination\u0026quot;` Response will be a paginated result of coverages stored inside\n{ \u0026#34;has_next\u0026#34;: false, \u0026#34;data\u0026#34;: { \u0026#34;rakutentech/laravel-request-docs\u0026#34;: [ { \u0026#34;id\u0026#34;: 1, \u0026#34;org_name\u0026#34;: \u0026#34;rakutentech\u0026#34;, \u0026#34;repo_name\u0026#34;: \u0026#34;laravel-request-docs\u0026#34;, \u0026#34;branch_name\u0026#34;: \u0026#34;develop\u0026#34;, \u0026#34;commit_hash\u0026#34;: \u0026#34;a124...ebffe42c3f113066103eca9\u0026#34;, \u0026#34;commit_author\u0026#34;: \u0026#34;james.bond\u0026#34;, \u0026#34;language\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;percentage\u0026#34;: 33.03, \u0026#34;created_at\u0026#34;: \u0026#34;2022-04-04T23:17:04.400701+09:00\u0026#34;, \u0026#34;updated_at\u0026#34;: \u0026#34;2022-04-05T17:15:59.62489+09:00\u0026#34; }, { \u0026#34;id\u0026#34;: 2, \u0026#34;org_name\u0026#34;: \u0026#34;rakutentech\u0026#34;, \u0026#34;repo_name\u0026#34;: \u0026#34;laravel-request-docs\u0026#34;, \u0026#34;branch_name\u0026#34;: \u0026#34;feature/test\u0026#34;, \u0026#34;commit_hash\u0026#34;: \u0026#34;a125...ebffe42c3f113066103eca9\u0026#34;, \u0026#34;commit_author\u0026#34;: \u0026#34;james.bond\u0026#34;, \u0026#34;language\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;percentage\u0026#34;: 43.03, \u0026#34;created_at\u0026#34;: \u0026#34;2022-04-05T14:10:58.254005+09:00\u0026#34;, \u0026#34;updated_at\u0026#34;: \u0026#34;2022-04-05T14:10:58.254005+09:00\u0026#34; } ], \u0026#34;rakutentech/awesome_app\u0026#34;: [ { \u0026#34;id\u0026#34;: 3, \u0026#34;org_name\u0026#34;: \u0026#34;rakutentech\u0026#34;, \u0026#34;repo_name\u0026#34;: \u0026#34;awesome_app\u0026#34;, \u0026#34;branch_name\u0026#34;: \u0026#34;develop\u0026#34;, \u0026#34;commit_hash\u0026#34;: \u0026#34;a123...ebffe42c3f113066103eca9\u0026#34;, \u0026#34;commit_author\u0026#34;: \u0026#34;james.bond\u0026#34;, \u0026#34;language\u0026#34;: \u0026#34;go\u0026#34;, \u0026#34;percentage\u0026#34;: 30.02, \u0026#34;created_at\u0026#34;: \u0026#34;2022-04-05T21:10:27.716515+09:00\u0026#34;, \u0026#34;updated_at\u0026#34;: \u0026#34;2022-04-05T21:10:48.367029+09:00\u0026#34; } ] } } "},{"id":7,"href":"/code-coverage-dashboard/API/get_coverages_badge_api/","title":"GET /coverages-api/badge","parent":"3. API","content":"Get the Badge\nquery:\u0026quot;org_name\u0026quot; json:\u0026quot;org_name\u0026quot; validate:\u0026quot;required\u0026quot; query:\u0026quot;repo_name\u0026quot; json:\u0026quot;repo_name\u0026quot; validate:\u0026quot;required\u0026quot; query:\u0026quot;branch_name\u0026quot; json:\u0026quot;branch_name\u0026quot; validate:\u0026quot;required\u0026quot; query:\u0026quot;language\u0026quot; json:\u0026quot;language\u0026quot; validate:\u0026quot;required,oneof=go php js\u0026quot; query:\u0026quot;subtitle\u0026quot; json:\u0026quot;subtitle\u0026quot;` localhost:3006/coverages-api/badge\\ ?org_name=\u0026lt;org-name\u0026gt;\\ \u0026amp;repo_name=\u0026lt;repo-name\u0026gt;\\ \u0026amp;branch_name=\u0026lt;branch-name\u0026gt;\\ \u0026amp;language=\u0026lt;language\u0026gt; "},{"id":8,"href":"/code-coverage-dashboard/API/get_coverages_health_api/","title":"GET /coverages-api/health","parent":"3. API","content":"Health Check endpoint\ncurl localhost:3006/coverages-api/health Response\n{\u0026#34;success\u0026#34;:\u0026#34;local\u0026#34;} "},{"id":9,"href":"/code-coverage-dashboard/usage/installation/","title":"Github Actions","parent":"2. Usage","content":"\nTo use the Code Coverage Dashboard, you need to host the Code Coverage Dashboard server in your environment first and then add the following 2 actions to the repository.\non push / on pull request : Publish code coverage report     The Action triggered by on push / on pull request will post a report to the Code Coverage Dashboard that hosted on your environment. This will comment the coverage result to PR if on pull request.\nsteps:- name:Code Coverage Dashboarduses:rakutentech/code-coverage-dashboard@v1with:language:\u0026#34;go\u0026#34;api_host:\u0026#34;https://\u0026lt;your-host\u0026gt;/coverages-api\u0026#34;report_dir:\u0026#34;build\u0026#34;coverage_xml_file_name:\u0026#34;coverage.xml\u0026#34;Parameters (on push / on pull request)        Name Required Example Description     api_host ◯ https://\u0026lt; your-host \u0026gt;/coverages-api Code Coverage API URL that is hosted on your environment.   language ◯ go go / php / js is supported.   report_dir ◯ build Directory path where the report is located. Should define by a relative path from the root directory.   coverage_xml_file_name ◯ coverage.xml Coverage coverage report name that should be under report_dir.   ui_host ✕ https://\u0026lt; your-host \u0026gt;/coverages-ui Optional. Code Coverage UI host. [ Default: \u0026lt; api_host \u0026gt;/../coverages-ui ]   working_dir ✕ ./sub_directory Optional. Used for specifying the sub directory that working on. [ Default: ./ (current directory) ].   skip_pr_comment ✕ true Optional. Enable to skip Pull Request comment. [ Default: false ]    on delete : Sync code coverage report     The Action triggered by on delete will sync branches information with the Code Coverage Dashboard that hosted on your environment.\nsteps:- name:Sync active branchesuses:rakutentech/code-coverage-dashboard@v1with:api_host:\u0026#34;https://\u0026lt;your-host\u0026gt;/coverages-api\u0026#34;Parameters (on delete)        Name Required Example Description     api_host ◯ https://\u0026lt; your-host \u0026gt;/coverages-api Code Coverage API URL that is hosted on your environment.    "},{"id":10,"href":"/code-coverage-dashboard/getting_started/installation/","title":"Installation","parent":"1. Getting Started","content":"Using Docker     Not implemented yet\ndocker-compose up -d Setup Manually     0. Pre requisites        Lang Version     Nodejs 16.0   Golang 1.18   Sqlite3 or Mysql -   Caddy 2.4.*    1. Clone this repository     git clone https://github.com/rakutentech/code-coverage-dashboard.git 2. Set up backend server     Copy .env file from example then     Update your database username/password in case of database driver.\ncp server/.env.local cp server/.env Migrate tables     cd ./server go run cmd/db_migrate/main.go Start API Server     cd ./server go run main.go \u0026lt;port\u0026gt; 3. Start Static file server     You can choose any static file server of your choice. The port is reverse proxied through the API server.\ncaddy file-server --root ./server/assets --listen localhost:3008 --browse 4. Start Client server     cp client/.env.local cp client/.env pnpm install pnpm build pnpm start "},{"id":11,"href":"/code-coverage-dashboard/usage/jenkins/","title":"Jenkins","parent":"2. Usage","content":"Jenkins     TODO\n"},{"id":12,"href":"/code-coverage-dashboard/API/post_coverages_api/","title":"POST /coverages-api","parent":"3. API","content":"POST the archive tar that has coverage HTML and Cover XML to the API endpoint.\nAPI stores the HTML for static view. Cover XML for parsing total percentage. Responds with the coverages for this org/repo for all branches.\nUse this API to create new coverage from Github Actions.\ncurl -X POST -H 'Content-Type: multipart/form-data' -H 'Authorization: GITHUB_TOKEN' \\ --form file=@/Users/pulkit.kathuria/git/code-coverage-dashboard/server/test_data/go_coverage.tar.gz \\ \u0026quot;localhost:3006/coverages-api\\ ?org_name=rakutentech\\ \u0026amp;branch_name=develop\\ \u0026amp;github_api_url=https://api.github.com\\ \u0026amp;repo_name=laravel-request-docs\\ \u0026amp;commit_hash=a123...5716217f903ebffe42c3f113066103eca9\\ \u0026amp;commit_author=pulkit.kathuria\\ \u0026amp;language=go\\ \u0026amp;coverage_xml_file_name=coverage.xml\u0026quot; Example Response\n{ \u0026#34;coverage\u0026#34;: { \u0026#34;id\u0026#34;: 15, \u0026#34;org_name\u0026#34;: \u0026#34;rakuten\u0026#34;, \u0026#34;repo_name\u0026#34;: \u0026#34;laravel-request-docs\u0026#34;, \u0026#34;branch_name\u0026#34;: \u0026#34;develop\u0026#34;, \u0026#34;commit_hash\u0026#34;: \u0026#34;a123...5716217f903ebffe42c3f113066103eca9\u0026#34;, \u0026#34;commit_author\u0026#34;: \u0026#34;pulkit.kathuria\u0026#34;, \u0026#34;language\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;percentage\u0026#34;: 33.03, \u0026#34;created_at\u0026#34;: \u0026#34;2022-04-07T09:21:56.879+09:00\u0026#34;, \u0026#34;updated_at\u0026#34;: \u0026#34;2022-04-07T09:21:56.879+09:00\u0026#34; }, \u0026#34;data\u0026#34;: [ { \u0026#34;id\u0026#34;: 3, \u0026#34;org_name\u0026#34;: \u0026#34;rakuten\u0026#34;, \u0026#34;repo_name\u0026#34;: \u0026#34;laravel-request-docs\u0026#34;, \u0026#34;branch_name\u0026#34;: \u0026#34;develop\u0026#34;, \u0026#34;commit_hash\u0026#34;: \u0026#34;a123...5716217f903ebffe42c3f113066103eca9\u0026#34;, \u0026#34;commit_author\u0026#34;: \u0026#34;pulkit.kathuria\u0026#34;, \u0026#34;language\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;percentage\u0026#34;: 43.03, \u0026#34;created_at\u0026#34;: \u0026#34;2022-04-05T21:10:27.716515+09:00\u0026#34;, \u0026#34;updated_at\u0026#34;: \u0026#34;2022-04-05T21:10:48.367029+09:00\u0026#34; }, { \u0026#34;id\u0026#34;: 2, \u0026#34;org_name\u0026#34;: \u0026#34;rakuten\u0026#34;, \u0026#34;repo_name\u0026#34;: \u0026#34;laravel-request-docs\u0026#34;, \u0026#34;branch_name\u0026#34;: \u0026#34;master\u0026#34;, \u0026#34;commit_hash\u0026#34;: \u0026#34;a123...5716217f903ebffe42c3f113066103eca9\u0026#34;, \u0026#34;commit_author\u0026#34;: \u0026#34;pulkit.kathuria\u0026#34;, \u0026#34;language\u0026#34;: \u0026#34;php\u0026#34;, \u0026#34;percentage\u0026#34;: 33.03, \u0026#34;created_at\u0026#34;: \u0026#34;2022-04-05T21:10:27.716515+09:00\u0026#34;, \u0026#34;updated_at\u0026#34;: \u0026#34;2022-04-05T21:10:48.367029+09:00\u0026#34; }, { ...repo data for other branches } ] } "},{"id":13,"href":"/code-coverage-dashboard/API/put_coverages_api/","title":"PUT /coverages-api","parent":"3. API","content":"Update the current branches from Github Actions. Use this API in the end of action or on a, action cronjob to delete old branches from the dashboard.\ncurl \\ -X PUT \\ -H \u0026#39;Content-Type: application/json\u0026#39; \\ -H \u0026#39;Authorization: GITHUB_TOKEN\u0026#39; \\ -d \u0026#39;{ \u0026#34;org_name\u0026#34;: \u0026#34;rakutentech\u0026#34;, \u0026#34;repo_name\u0026#34;: \u0026#34;laravel-request-docs\u0026#34;, \u0026#34;github_api_url\u0026#34;: \u0026#34;api.github.com\u0026#34;, \u0026#34;commit_hash\u0026#34;: \u0026#34;abc\u0026#34;, \u0026#34;active_branches\u0026#34;: [\u0026#34;develop\u0026#34;, \u0026#34;master\u0026#34;] }\u0026#39; \\ \u0026#34;http://localhost:3006/coverages-api\u0026#34; "},{"id":14,"href":"/code-coverage-dashboard/others/reverse_proxy/","title":"Reverse Proxy","parent":"9. Others","content":"Using it in a reverse proxy     # serve api for GHE actions ProxyPass /coverages-api http://localhost:3006 ProxyPassReverse /coverages-api http://localhost:3006 "},{"id":15,"href":"/code-coverage-dashboard/tags/","title":"Tags","parent":"Code Coverage Dashboard","content":""},{"id":16,"href":"/code-coverage-dashboard/getting_started/verify/","title":"Verify","parent":"1. Getting Started","content":"Services        Domain Purpose     /coverages-api/health Health Check for the service   /coverages-api Serves GET, POST, PUT API for Github Actions and the Dashboard   /coverages-api/badge Provides a badge   /coverages-api/assets Provides assets of artifacts   /coverages-api/dashboard Code coverage dashboard    "}]